Bot
    - installs rootkit
    - runs code in explorer or svchost
    - executes commands from Botcmd? (below)
        - video, download, killos, rdp, screenshot, runfile, killprocess,
          logonpasswords (which I think is just mimikatz), elevation, uac, etc.
        - see botcmd/source/main.cpp for list of commands sent to bot

    - source\main.cpp
        - main()
            - starts bot
            - malicious
        - StartBot()
            - starts bot
            - calls injection into process
            - malicious
        - StartBotApart()
            - initializes rootkit
            - malicious
        - InstallBot
            - installs as service
            - sets autorun attribute
            - malicious
    - source\rootkit.cpp
        - RootkitEntry
            - starts keylogger
            - initializes screenshot functionality
            - malicious
    - source\AdminPanel.cpp
        - GetCmd
            - receives commands to perform activities
            - malicious
        - SendData
            - sends data
            - malicious
        - AdminPanelThread
            - initializes server
        - AdminPanelProcess
            - process which gets injected (supposedly)
            - malicious
    - source\explorer_loop.cpp
        - RunInExplorer2
            - calls InjectIntoProcess2()
            - malicious
        - ExplorerLoop
            - runs in explorer.exe
            - keeps malware persistent
            - malicious
    - source\config.cpp
        - general config functionality
        - decode/encode strings
        - not malicious in general
    - source\Manager.cpp
        - Handler
            - distributes handlers for each bot command
            - malicious
        - SendFileToVideoServer
            - sends file to server
            - malicious
        - SendData
            - sends data to server
            - malicious
    - source\keylogger.cpp
        - StartKeyLoggerFirstNScreenshot
            - starts keylogger
            - malicious
    - source\service.cpp
        - creates service
        - not malicious
    - source\VideoServer.cpp
        - Run
            - runs video server
            - malicious
        - VideoServerProcess
            - process which gets injected (supposedly)
            - malicious
    - source\abstract.cpp
        - not malicious
    - source\task.cpp
        - ProtectBot
            - protects bot from being killed
            - malicious
        - ExecCmd_Video
            - records video
            - malicious
        - HandlerDownloadLoadFile
            - downloads file onto victim host
            - malicious
        - RunAmmyy
            - run ammyy remote desktop service
            - malicious
        - RunOrInstallAmmyy
            - run ammyy remote desktop service
            - malicious
        - ExecCmd_KillOs
            - kills os
            - malicious
        - ExecCmd_Tunnel
            - creates tunnel
            - malicious
        - ExecCmd_RDP
            - turn on remote control
            - malicious
        - ExecCmd_LogonPasswords
            - gets logon passwords via mimikatz
            - malicious
        - ScreenshotFunc
            - gets screenshot
            - malicious
        - ExecCmd_Dupl
            - duplicates malware
            - malicious
        - ExecCmd_VNC
            - starts VNC service
            - malicious
        - ExecCmd_RunFile
            - executes file
            - malicious
        - ExecCmd_TinyMet
            - tiny meterpreter functionality
            - malicious
        - ExecCmd_KillProcess
            - kills processes
            - malicious
        - ExecCmd_RunPlug
            - runs plugins
            - malicious
        - AutorunLoadedPlugin
            - automatically run plugin
            - malicious
    - source\sandbox.cpp
        - JumpToRundll32
            - runs dll
            - malicious
        - ProcessExec & ExecDirect
            - runs process
            - malicious
    - source\MonitoringProcesses.cpp
        - monitors process that have been infected by malware
        - MonitoringCallback()
            - patches processes for rdp
            - executes commandline
            - injects into processes
            - malicious
    - source\tools.cpp
        - AddAllowedprogram
            - modifies firewall to allow program and communications
            - malicious
        - KillOs1 & KillOs2
            - kills os
            - malicious
        - Reboot
            - reboots host
            - malicious
    - source\info.cpp
        - not malicious
    - source\wincmd.cpp
        - Init()
            - initializes cmd.exe
            - malicious
        - Handler
            - passes commands to cmd.exe
            - malicious
    - source\plugin.cpp
        - handles plugins
        - ExecuteFunc
            - executes plugin's function
            - malicious
        - LoadedPlugin
            - runs plugin as a process
            - malicious
    - source\AV.cpp
        - AVDetect
            - detects AV processes
            - malicious
    - source\ReflectiveLoader.cpp
        - ReflectiveLoader
            - reflectively loads code
            - malicious
            - but not in bot. only in bot dll
    - source\other\mimikatz.cpp
        - just calls mimikatz functionality
        - not malicious. just passthroughs really
    - source\other\rdp_patch.cpp
        - PatchRDPFiles
            - patches files for rdp
            - malicious
    - source\other\secure_lsa.cpp
        - Lsa
            - modifies lsa registry content
            - malicious
    - source\other\GetProxy.cpp
        - retrieves proxy server ip's and types
        - not malicious
    - source\other\FindFiles.cpp
        - finds cab files to send to server
        - not malicious
    - source\other\vnc.cpp
        - ThreadVNC
            - vnc service
            - malicious
    - source\other\ListProcess.cpp
        - lists processes
        - not malicious
    - source\plugins\plugins.cpp
        - not malicious
    - source\plugins\TrustedHosts.cpp
        - finds trusted hosts
        - looks like it's just a check
        - not malicious
    - source\plugins\FindOutlookFiles.cpp
        - finds outlook files
        - not malicious
    - source\plugins\MonitoringFile.cpp
        - MonitoringCB
            - monitors POS memory for credit cards
**      - not sure why I can't find this in the binary. should be easy to find.
          thus I think it was never compiled into it
    - source\system\system.cpp
        - not malicious
    - source\system\ifobs.cpp
        - targets users who use ifobs banking
        - Start()
            - starts functionality to steal banking credentials from victim host
            - malicious
        - SendDataFromPlugin() & GrabData()
            - retrieves passwords and keys
            - malicious
        - Exec()
            - gets logon information
            - malicious
**      - not sure why I can't find this in the binary. should be easy to find.
          thus I think it was never compiled into it
    - source\system\FormGrabber.cpp
        - filters packet sniffing on GET/POST traffic
        - CallbackSniffer
            - malicious

    - ../../core/source/injects/RunInjectCode2.cpp
        - RunInjectCode2
            - injects code
            - malicious
    - ../../core/source/injects/svchost.cpp
        - RunSvchost
            - executes process inside of svchost
            - malicious
    - ../../core/source/injects/InjectIntoProcess2.cpp
        - InjectIntoProcess2
            - malicious
    - ../../core/source/keylogger.cpp
        - just conditionals on filtereing what is being keylogged
        - not malicious
    - ../../core/source/hook/ZwResumeThread.cpp
        - Join_ZwResumeThread
            - hooks ZwResumeThread
            - malicious
        - Hook_ZwResumeThread
            - replaced ZwResumeThread function
            - malicious
    - ../../core/source/hook/hook.cpp
        - Set
            - replaces original function with new one
            - malicious
        - Join_Func
            - calls Set
            - malicious
    - ../../core/source/Service.cpp
        - Start
            - starts service
            - not malicious
    - ../../mimikatz/source/mimikatz.cpp
        - MimikatzPatchRDP
            - patches process for rdp
            - malicious
        - ExtactAllLogons
            - extracts logons
            - malicious
    - ../../core/source/sniffer.cpp
        - packet sniffer
        - Filter
            - malicious
    - ../../WndRec/source/video.cpp
        - Record
            - records screen video
        - MakeScreenShot
            - takes screenshot

Botcmd
    - executes a variety of commands
    - sends these commands to Bot? (above)

    - main()
        - loop to receive/send commands
        - malicious
    - CmdSendBot()
        - sends commands to bot via pipe
        - malicious
    - CmdInfo()
        - gets info of victim host
        - not malicious
    - CmdGetProxy()
        - gets proxy that bot is using (http, https, socks5)
        - not malicious
    - CmdUAC()
        - elevates privileges UAC_aq() -> UACProcess() -> Elevation::COM()
        - bypasses UAC calling UAC_cb() -> Elevation::UACBypass()
        - malicious
    - CmdElevation()
        - Elevation::NDProxy()
        - malicious

Builder
    - malware builder
    - not malicious. just takes in exe files and configs and produces more exe files

Downloader
    - a file dropper. communicates with c&c server
    - main()
        - installs dropper
        - evades detection from Kaspersky
        - malicious
    - MainLoop()
        - gets commands from adminpanel and executes them
            - download, update, or rundll
        - malicious

Tool
    - just a tool for hashing, encoding/decoding, etc.
    - not malicious

Plugins (as DLL's):
    - AutorunSidebar
        - SetAutorun()
            - sets malware to autorun  & modifies Windows sidebar (not sure why)
            - malicious
    - cve
        - Execute()
            - executes Elevation::CVE2014_4113()
            - I don't think this is as malicious as the CVE itself
        - CVE2014_4113() (in ./core/source/elevation/CVE2014-4113.cpp)
            - not malicious
            - just starts thread (calls ThreadProc())
            - I think ThreadProc() is really the malicious portion
        - ThreadProc()
            - executes CVE
            - malicious
    - rdpwrap
        - install.cpp is where the malicious stuff is located
        - RdpWrapInstall()
            - installs RDP service
            - modifies firewall rules
            - malicious
